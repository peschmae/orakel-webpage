<h2>Namespace Hardening Checks</h2>
{{ range .Checks }}
<details name="nhc">
  <summary role="button" class="outline">
    {{ if .Successful }}
      <span style="color: green;">&#10004;</span>
    {{ else if .Running  }}
      <span style="color: orange;">&#9888;</span>
    {{ else }}
      <span style="color: red;">&#10008;</span>
    {{ end }}
    {{ .ObjectMeta.Name }}
  </summary>
  <div class="grid" style="padding-bottom: 20px;">
    <div>
      <strong>Status: </strong>{{ if .Successful }}
        <span style="color: green;">&#10004;</span>
      {{ else if .Running  }}
        <span style="color: orange;">&#9888;</span>
      {{ else }}
        <span style="color: red;">&#10008;</span>
      {{ end }}
    </div>
    <div>
      <strong>Target Namespace:</strong> {{ .Spec.TargetNamespace }}
    </div>
    <div>
      <strong>Recording Duration:</strong> {{ .Spec.RecordingDuration }}
    </div>
  </div>

  <h4>Associated Workload Hardening Checks</h4>
  <section style="width: 80%; margin-left: auto; margin-right: auto;">
    {{ if .WorkloadHardeningChecks }}
      {{ range .WorkloadHardeningChecks }}
        {{ $whc := . }}
        <details name="nhc-{{ .ObjectMeta.Name }}">
          <summary role="button" class="outline secondary">
            {{ if .Successful }}
              <span style="color: green;">&#10004;</span>
            {{ else if .Running  }}
              <span style="color: orange;">&#9888;</span>
            {{ else }}
              <span style="color: red;">&#10008;</span>
            {{ end }}
            {{ .ObjectMeta.Name }}
          </summary>
          <div class="grid" style="padding-bottom: 20px;">
            <div>
              <strong>Status: </strong>{{ if .Successful }}
                <span style="color: green;">&#10004; Successful</span>
              {{ else if .Running  }}
                <span style="color: orange;">&#9888; Running</span>
              {{ else }}
                <span style="color: red;">&#10008; Failed</span>
              {{ end }}
            </div>
            <div>
              <strong>Target Reference:</strong> {{ .Spec.TargetRef.Kind }}/{{ .Spec.TargetRef.Name }}
            </div>
            <div>
              <strong>Duration:</strong> {{ .Spec.RecordingDuration }}
            </div>
          </div>

          {{ if not .GetRecordings }}
            <p>No recordings available.</p>
          {{ else }}
            <h4>Check Runs</h4>
            {{ range $key, $checkRun := .GetRecordings }}
            <details name="{{ $whc.ObjectMeta.Namespace}}-{{ $whc.ObjectMeta.Name }}-checkruns">
              <summary role="button" class="outline secondary">
                {{ if $checkRun.Success }}
                  <span style="color: green;">&#10004;</span>
                {{ else }}
                  <span style="color: red;">&#10008;</span>
                {{ end }}
                {{ $checkRun.Type }}
              </summary>
              <h5>Logs</h5>
              {{ if not $checkRun.Logs }}
                <p>No logs available.</p>
              {{ else }}
                {{ range $container, $logs := $checkRun.Logs }}
                  <h6>Container: {{ $container }}</h6>
                  <pre>{{ $logs | join "\n"}}</pre>
                {{ end }}
              {{ end }}

                
            </details>
            {{ end }}
          {{ end }}
        </details>
      {{ end }}
    {{ else }}
      <p>No associated Workload Hardening Checks found.</p>
    {{ end }}
  </section>
</details>
{{ end }}

<hr />